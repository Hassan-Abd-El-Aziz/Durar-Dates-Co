// كائنات النصوص للغتين
const translations = {
  en: {
    title: "Durar Dates | Premium Saudi Dates",
    logo: "Durar Al-Tamur Foundation",
    home: "Home",
    about: "About Us",
    products: "Our Products",
    location: "Location",
    contact: "Contact Us",
    heroTitle: "Durar Dates Foundation",
    heroText:
      "Premium luxury dates from the finest farms in Saudi Arabia, offering you the finest types of dates at competitive prices and unparalleled quality.",
    contactBtn: "Contact Us",
    aboutTitle: "About Us",
    aboutText1:
      "Durar Dates Foundation was established in 2010 as a leading institution in the trade of luxury dates in Saudi Arabia.",
    aboutText2:
      "We pride ourselves on providing the finest types of dates from our own carefully selected farms, while maintaining the highest standards of quality and hygiene.",
    aboutText3:
      "We have a team of experts who follow the production process from the palm stage to packaging to ensure our products reach you in the best condition.",
    productsTitle: "Our Products",
    product1Title: "Amber Dates",
    product1Desc:
      "One of the finest types of dates, distinguished by its golden color and unique flavor rich in nutritional benefits.",
    product2Title: "Sukkary Dates",
    product2Desc:
      "Characterized by its large size, light brown color, and natural sweet taste that makes it one of the most requested types.",
    product3Title: "Khidri Dates",
    product3Desc:
      "Distinguished by its dark brown color and soft texture, rich in fiber and iron.",
    product4Title: "Safawi Dates",
    product4Desc:
      "Characterized by its shiny black color and smooth texture, one of the richest dates in minerals and vitamins.",
    product5Title: "Majdool Dates",
    product5Desc:
      "The king of dates with its large size and luxurious taste, characterized by its high nutritional value.",
    product6Title: "Premium Dates Mix",
    product6Desc:
      "A distinctive blend of the finest types of dates in studied proportions to obtain a unique tasting experience.",
    locationTitle: "Our Location",
    locationInfoTitle: "Foundation Headquarters",
    locationAddress: "Saudi Arabia - Riyadh - Al Olaya District",
    workingHours: "Sunday - Thursday: 8 AM - 5 PM",
    getDirections: "Get Directions",
    contactTitle: "Contact Us",
    nameLabel: "Name",
    emailLabel: "Email",
    messageLabel: "Message",
    sendBtn: "Send",
    contactInfoTitle: "Contact Information",
    contactInfoText:
      "We are always ready to respond to your inquiries and requests during official working hours.",
    quickLinks: "Quick Links",
    productsFooter: "Products",
    contactFooter: "Contact Us",
    footerAbout:
      "A leading institution in the trade of luxury dates, offering the finest types with high quality standards.",
    copyright: " Durar Dates Foundation. All rights reserved © 2025",
  },
  ar: {
    title: "درر التمور | تمور سعودية فاخرة",
    logo: "مؤسسة درر التمور",
    home: "الرئيسية",
    about: "من نحن",
    products: "منتجاتنا",
    location: "أين نحن",
    contact: "تواصل معنا",
    heroTitle: "مؤسسة درر التمور",
    heroText:
      "نخبة التمور الفاخرة من أجود مزارع المملكة العربية السعودية، نقدم لكم أجود أنواع التمور بأسعار تنافسية وجودة لا مثيل لها.",
    contactBtn: "اتصل بنا",
    aboutTitle: "من نحن",
    aboutText1:
      "تأسست مؤسسة درر التمور عام 2010 كمؤسسة رائدة في مجال تجارة التمور الفاخرة بالمملكة العربية السعودية.",
    aboutText2:
      "نفتخر بأننا نقدم أجود أنواع التمور من مزارعنا الخاصة والمختارة بعناية، مع الحفاظ على أعلى معايير الجودة والنظافة.",
    aboutText3:
      "لدينا فريق من الخبراء الذين يتابعون عملية الإنتاج من مرحلة النخيل حتى التعبئة والتغليف لضمان وصول منتجاتنا إليكم بأفضل حال.",
    productsTitle: "منتجاتنا",
    product1Title: "تمر العنبرة",
    product1Desc:
      "من أجود أنواع التمور، يتميز بلونه الذهبي ومذاقه الفريد الغني بالفوائد الغذائية.",
    product2Title: "تمر السكري",
    product2Desc:
      "يتميز بحجمه الكبير ولونه البني الفاتح ومذاقه الحلو الطبيعي الذي يجعله من أكثر الأنواع طلباً.",
    product3Title: "تمر الخضري",
    product3Desc:
      "من التمور المميزة بلونه البني الغامق وقوامه الطري، غني بالألياف والحديد.",
    product4Title: "تمر الصفاوي",
    product4Desc:
      "يتميز بلونه الأسود اللامع وقوامه الناعم، من أكثر التمور غنى بالمعادن والفيتامينات.",
    product5Title: "تمر المجدول",
    product5Desc:
      "ملك التمور بحجمه الكبير ومذاقه الفاخر، يتميز بقيمته الغذائية العالية.",
    product6Title: "خلطة التمور الفاخرة",
    product6Desc:
      "مزيج مميز من أجود أنواع التمور بنسب مدروسة للحصول على تجربة تذوق فريدة.",
    locationTitle: "أين نحن",
    locationInfoTitle: "مقر المؤسسة",
    locationAddress: "المملكة العربية السعودية - الرياض - حي العليا",
    workingHours: "الأحد - الخميس: 8 صباحاً - 5 مساءً",
    getDirections: "احصل على الاتجاهات",
    contactTitle: "تواصل معنا",
    nameLabel: "الاسم",
    emailLabel: "البريد الإلكتروني",
    messageLabel: "الرسالة",
    sendBtn: "إرسال",
    contactInfoTitle: "معلومات التواصل",
    contactInfoText:
      "نحن دائماً على استعداد للرد على استفساراتكم وطلباتكم خلال أوقات العمل الرسمية.",
    quickLinks: "روابط سريعة",
    productsFooter: "المنتجات",
    contactFooter: "تواصل معنا",
    footerAbout:
      "مؤسسة رائدة في تجارة التمور الفاخرة، نقدم أجود الأنواع بمعايير جودة عالية.",
    copyright: "مؤسسة درر التمور. جميع الحقوق محفوظة © 2025",
  },
};

// تغيير اللغة
function changeLanguage(lang) {
  document.documentElement.lang = lang;
  document.documentElement.dir = lang === "ar" ? "rtl" : "ltr";

  // تحديث النصوص
  const elements = document.querySelectorAll("[data-i18n]");
  elements.forEach((el) => {
    const key = el.getAttribute("data-i18n");
    if (translations[lang][key]) {
      el.textContent = translations[lang][key];
    }
  });

  // تحديث نص زر تبديل اللغة
  const langButtons = document.querySelectorAll(".lang-switch");
  langButtons.forEach((btn) => {
    btn.textContent = lang === "ar" ? "EN" : "AR";
  });

  // حفظ التفضيل
  localStorage.setItem("language", lang);
}

// تبديل الوضع الليلي/النهاري
function toggleTheme() {
  const currentTheme = document.documentElement.getAttribute("data-theme");
  const newTheme = currentTheme === "dark" ? "light" : "dark";

  document.documentElement.setAttribute("data-theme", newTheme);
  localStorage.setItem("theme", newTheme);

  // تحديث أيقونة الزر
  const themeIcons = document.querySelectorAll(".theme-toggle i");
  themeIcons.forEach((icon) => {
    icon.className = newTheme === "dark" ? "fas fa-sun" : "fas fa-moon";
  });
}

// تهيئة القائمة الجانبية للهاتف
function setupMobileMenu() {
  const hamburger = document.getElementById("hamburger");
  const mobileMenu = document.getElementById("mobileMenu");

  hamburger.addEventListener("click", () => {
    hamburger.classList.toggle("active");
    mobileMenu.classList.toggle("active");

    // تبديل أيقونة الهامبرجر
    if (hamburger.classList.contains("active")) {
      document.body.style.overflow = "hidden";
    } else {
      document.body.style.overflow = "";
    }
  });

  // إغلاق القائمة عند النقر على رابط
  const mobileLinks = mobileMenu.querySelectorAll("a");
  mobileLinks.forEach((link) => {
    link.addEventListener("click", () => {
      hamburger.classList.remove("active");
      mobileMenu.classList.remove("active");
      document.body.style.overflow = "";
    });
  });

  // نسخ أحداث تبديل اللغة والوضع الليلي للنسخة الموبايل
  document.getElementById("langSwitchMobile").addEventListener("click", () => {
    const currentLang = document.documentElement.lang;
    const newLang = currentLang === "ar" ? "en" : "ar";
    changeLanguage(newLang);
  });

  document
    .getElementById("themeToggleMobile")
    .addEventListener("click", toggleTheme);
}

// تهيئة الخريطة
function initMap() {
  const map = L.map("map").setView([24.7136, 46.6753], 15);

  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    attribution:
      '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
  }).addTo(map);

  L.marker([24.7136, 46.6753])
    .addTo(map)
    .bindPopup("مؤسسة درر التمور")
    .openPopup();
}

// تهيئة النموذج
function setupForm() {
  const form = document.getElementById("contactForm");

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    // هنا يمكنك إضافة كود إرسال النموذج
    alert("تم إرسال رسالتك بنجاح! سنتواصل معك قريباً.");
    form.reset();
  });
}

// تهيئة الصفحة عند التحميل
document.addEventListener("DOMContentLoaded", () => {});

// تأثيرات التمرير
function setupScrollAnimations() {
  const scrollElements = document.querySelectorAll("[data-scroll]");

  const elementInView = (el, offset = 0) => {
    const elementTop = el.getBoundingClientRect().top;
    return (
      elementTop <=
      (window.innerHeight || document.documentElement.clientHeight) - offset
    );
  };

  const displayScrollElement = (element) => {
    element.classList.add("animated");
  };

  const handleScrollAnimation = () => {
    scrollElements.forEach((el) => {
      if (elementInView(el, 100)) {
        displayScrollElement(el);
      }
    });
  };

  // تنشيط العناصر المرئية عند التحميل
  window.addEventListener("load", () => {
    scrollElements.forEach((el) => {
      if (elementInView(el, 100)) {
        displayScrollElement(el);
      }
    });
  });

  // تنشيط العناصر عند التمرير
  window.addEventListener("scroll", () => {
    handleScrollAnimation();
  });
}

// استدعاء الدالة في تهيئة الصفحة
document.addEventListener("DOMContentLoaded", () => {
  // تحميل تفضيلات اللغة
  const savedLang = localStorage.getItem("language") || "ar";
  changeLanguage(savedLang);

  // تحميل تفضيلات الوضع الليلي
  const savedTheme = localStorage.getItem("theme") || "light";
  document.documentElement.setAttribute("data-theme", savedTheme);

  // تحديث أيقونة الوضع الليلي
  const themeIcons = document.querySelectorAll(".theme-toggle i");
  themeIcons.forEach((icon) => {
    icon.className = savedTheme === "dark" ? "fas fa-sun" : "fas fa-moon";
  });

  // أحداث الأزرار
  document.getElementById("langSwitch").addEventListener("click", () => {
    const currentLang = document.documentElement.lang;
    const newLang = currentLang === "ar" ? "en" : "ar";
    if (currentLang === "en") {
      document.body.dir = "rtl";
    } else {
      document.body.dir = "ltr";
    }
    changeLanguage(newLang);
    console.log(document.documentElement.dir);
  });

  document.getElementById("themeToggle").addEventListener("click", toggleTheme);

  // تهيئة المكونات الأخرى
  setupMobileMenu();
  initMap();
  setupForm();

  // تأثيرات الظهور عند التمرير
  const animateElements = document.querySelectorAll(
    ".product-card, .about-image, .contact-form, .location-info"
  );

  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("animate");
        }
      });
    },
    { threshold: 0.1 }
  );

  animateElements.forEach((el) => {
    observer.observe(el);
  });
  setupScrollAnimations();
});
